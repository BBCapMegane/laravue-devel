<source>
  @type  forward
  @id    input1
  @label @mainstream
  port  24224
</source>

<filter **>
  @type stdout
</filter>

<label @mainstream>
  <match *.ERROR>
    @type slack
    webhook_url https://hooks.slack.com/services/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
    username ryota_niikura
    channel bot-heaven
    icon_emoji :ghost:
    flush_interval 60s
  </match>
  <match yado.**>
    @type aws-elasticsearch-service
    type_name general_log
    include_tag_key true
    tag_key _key
    flush_interval 1s
    index_name yado

    <endpoint>
      url "#{ENV['ENDPOINT']}"
      region ap-northeast-1
      access_key_id "#{ENV['ACCESS_KEY']}"
      secret_access_key "#{ENV['SECRET_KEY']}"
    </endpoint>
  </match>
  <match admin.**>
    @type aws-elasticsearch-service
    type_name general_log
    include_tag_key true
    tag_key _key
    flush_interval 1s
    index_name admin

    <endpoint>
      url "#{ENV['ENDPOINT']}"
      region ap-northeast-1
      access_key_id "#{ENV['ACCESS_KEY']}"
      secret_access_key "#{ENV['SECRET_KEY']}"
    </endpoint>
  </match>
</label>